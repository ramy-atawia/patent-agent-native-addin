{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 Menlo-Regular;\f1\fnil\fcharset0 Menlo-Bold;\f2\fnil\fcharset0 Menlo-Italic;
}
{\colortbl;\red255\green255\blue255;\red115\green207\blue184;\red20\green20\blue20;\red207\green214\blue228;
\red131\green178\blue248;\red218\green124\blue212;\red114\green201\blue195;\red233\green160\blue109;\red153\green132\blue242;
\red205\green204\blue213;\red118\green180\blue255;\red255\green255\blue255;\red229\green189\blue123;}
{\*\expandedcolortbl;;\cssrgb\c51373\c83922\c77255;\cssrgb\c10196\c10196\c10196;\cssrgb\c84706\c87059\c91373;
\cssrgb\c58039\c75686\c98039;\cssrgb\c89020\c58039\c86275;\cssrgb\c50980\c82353\c80784;\cssrgb\c93725\c69020\c50196;\cssrgb\c66667\c60784\c96078;
\cssrgb\c83922\c83922\c86667;\cssrgb\c52941\c76471\c100000;\cssrgb\c100000\c100000\c100000;\cssrgb\c92157\c78431\c55294;}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\fs24 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 import\cf4 \strokec4  \{ \cf5 \strokec5 useState\cf4 \strokec4 , \cf5 \strokec5 useEffect\cf4 \strokec4  \} \cf2 \strokec2 from\cf4 \strokec4  \cf6 \strokec6 'react'\cf4 \strokec4 ;\cb1 \
\cf2 \cb3 \strokec2 import\cf4 \strokec4  \{ \cf5 \strokec5 isWordJsReady\cf4 \strokec4 , \cf5 \strokec5 waitForWordJs\cf4 \strokec4 , \cf5 \strokec5 isOfficeReady\cf4 \strokec4 , \cf5 \strokec5 isWordHost\cf4 \strokec4  \} \cf2 \strokec2 from\cf4 \strokec4  \cf6 \strokec6 '../office-init'\cf4 \strokec4 ;\cb1 \
\
\cf2 \cb3 \strokec2 export\cf4 \strokec4  \cf7 \cb3 \strokec7 interface\cf4 \cb3 \strokec4  \cf8 \cb3 \strokec8 UseWordJsReturn\cf4 \cb3 \strokec4  \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf9 \cb3 \strokec9 isReady\cf10 \strokec10 :\cf4 \cb3 \strokec4  \cf7 \cb3 \strokec7 boolean\cf4 \cb3 \strokec4 ;\cb1 \
\cb3   \cf9 \cb3 \strokec9 isLoading\cf10 \strokec10 :\cf4 \cb3 \strokec4  \cf7 \cb3 \strokec7 boolean\cf4 \cb3 \strokec4 ;\cb1 \
\cb3   \cf9 \cb3 \strokec9 error\cf10 \strokec10 :\cf4 \cb3 \strokec4  \cf7 \cb3 \strokec7 string\cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 |\cf4 \cb3 \strokec4  \cf7 \cb3 \strokec7 null\cf4 \cb3 \strokec4 ;\cb1 \
\cb3   
\f1\b \cf8 \cb3 \strokec8 execute
\f0\b0 \cf10 \strokec10 :\cf4 \cb3 \strokec4  <\cf8 \cb3 \strokec8 T\cf4 \cb3 \strokec4 >(
\f1\b \cf8 \cb3 \strokec8 operation
\f0\b0 \cf10 \strokec10 :\cf4 \cb3 \strokec4  () \cf7 \cb3 \strokec7 =>\cf4 \cb3 \strokec4  \cf11 \cb3 \strokec11 Promise\cf4 \cb3 \strokec4 <\cf8 \cb3 \strokec8 T\cf4 \cb3 \strokec4 >) \cf7 \cb3 \strokec7 =>\cf4 \cb3 \strokec4  \cf11 \cb3 \strokec11 Promise\cf4 \cb3 \strokec4 <\cf8 \cb3 \strokec8 T\cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 |\cf4 \cb3 \strokec4  \cf7 \cb3 \strokec7 null\cf4 \cb3 \strokec4 >;\cb1 \
\cb3 \}\cb1 \
\
\pard\pardeftab720\partightenfactor0

\f2\i \cf12 \cb3 \strokec12 /**
\f0\i0 \cf4 \cb1 \strokec4 \

\f2\i \cf12 \cb3 \strokec12  * Custom hook for safely using Word.js functionality
\f0\i0 \cf4 \cb1 \strokec4 \

\f2\i \cf12 \cb3 \strokec12  * Ensures Word.js is properly initialized before executing operations
\f0\i0 \cf4 \cb1 \strokec4 \

\f2\i \cf12 \cb3 \strokec12  */
\f0\i0 \cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 export\cf4 \strokec4  \cf7 \cb3 \strokec7 function\cf4 \cb3 \strokec4  
\f1\b \cf8 \cb3 \strokec8 useWordJs
\f0\b0 \cf4 \cb3 \strokec4 ()\cf10 \cb3 \strokec10 :\cf4 \cb3 \strokec4  \cf8 \cb3 \strokec8 UseWordJsReturn\cf4 \cb3 \strokec4  \{\cb1 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf7 \cb3 \strokec7 const\cf4 \cb3 \strokec4  [\cf9 \cb3 \strokec9 isReady\cf4 \cb3 \strokec4 , 
\f1\b \cf8 \cb3 \strokec8 setIsReady
\f0\b0 \cf4 \cb3 \strokec4 ] \cf10 \cb3 \strokec10 =\cf4 \cb3 \strokec4  \cf13 \cb3 \strokec13 useState\cf4 \cb3 \strokec4 (false);\cb1 \
\cb3   \cf7 \cb3 \strokec7 const\cf4 \cb3 \strokec4  [\cf9 \cb3 \strokec9 isLoading\cf4 \cb3 \strokec4 , 
\f1\b \cf8 \cb3 \strokec8 setIsLoading
\f0\b0 \cf4 \cb3 \strokec4 ] \cf10 \cb3 \strokec10 =\cf4 \cb3 \strokec4  \cf13 \cb3 \strokec13 useState\cf4 \cb3 \strokec4 (true);\cb1 \
\cb3   \cf7 \cb3 \strokec7 const\cf4 \cb3 \strokec4  [\cf9 \cb3 \strokec9 error\cf4 \cb3 \strokec4 , 
\f1\b \cf8 \cb3 \strokec8 setError
\f0\b0 \cf4 \cb3 \strokec4 ] \cf10 \cb3 \strokec10 =\cf4 \cb3 \strokec4  \cf13 \cb3 \strokec13 useState\cf4 \cb3 \strokec4 <\cf7 \cb3 \strokec7 string\cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 |\cf4 \cb3 \strokec4  \cf7 \cb3 \strokec7 null\cf4 \cb3 \strokec4 >(null);\cb1 \
\
\cb3   \cf13 \cb3 \strokec13 useEffect\cf4 \cb3 \strokec4 (() \cf7 \cb3 \strokec7 =>\cf4 \cb3 \strokec4  \{\cb1 \
\cb3     \cf7 \cb3 \strokec7 let\cf4 \cb3 \strokec4  \cf5 \strokec5 mounted\cf4 \strokec4  \cf10 \cb3 \strokec10 =\cf4 \cb3 \strokec4  true;\cb1 \
\cb3     \cf7 \cb3 \strokec7 let\cf4 \cb3 \strokec4  \cf5 \strokec5 timeoutId\cf10 \cb3 \strokec10 :\cf4 \cb3 \strokec4  \cf8 \cb3 \strokec8 NodeJS\cf4 \cb3 \strokec4 .\cf8 \cb3 \strokec8 Timeout\cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 |\cf4 \cb3 \strokec4  \cf7 \cb3 \strokec7 null\cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 =\cf4 \cb3 \strokec4  null; 
\f2\i \cf12 \strokec12 // Initialize as null
\f0\i0 \cf4 \cb1 \strokec4 \
\
\cb3     \cf7 \cb3 \strokec7 const\cf4 \cb3 \strokec4  
\f1\b \cf8 \cb3 \strokec8 initializeWordJs
\f0\b0 \cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 =\cf4 \cb3 \strokec4  \cf7 \cb3 \strokec7 async\cf4 \cb3 \strokec4  () \cf7 \cb3 \strokec7 =>\cf4 \cb3 \strokec4  \{\cb1 \
\cb3       \cf2 \strokec2 try\cf4 \strokec4  \{\cb1 \
\cb3         \cf10 \cb3 \strokec10 console\cf4 \cb3 \strokec4 .\cf8 \cb3 \strokec8 log\cf4 \cb3 \strokec4 (\cf6 \strokec6 'useWordJs: Starting initialization...'\cf4 \strokec4 );\cb1 \
\cb3         \cf13 \cb3 \strokec13 setIsLoading\cf4 \cb3 \strokec4 (true);\cb1 \
\cb3         \cf13 \cb3 \strokec13 setError\cf4 \cb3 \strokec4 (null);\cb1 \
\
\cb3         
\f2\i \cf12 \strokec12 // First check if Office.js is ready
\f0\i0 \cf4 \cb1 \strokec4 \
\cb3         \cf2 \strokec2 if\cf4 \strokec4  (\cf10 \cb3 \strokec10 !\cf13 \strokec13 isOfficeReady\cf4 \cb3 \strokec4 ()) \{\cb1 \
\cb3           \cf10 \cb3 \strokec10 console\cf4 \cb3 \strokec4 .\cf8 \cb3 \strokec8 log\cf4 \cb3 \strokec4 (\cf6 \strokec6 'useWordJs: Office.js not ready, waiting...'\cf4 \strokec4 );\cb1 \
\cb3           \cb1 \
\cb3           
\f2\i \cf12 \strokec12 // Wait up to 5 seconds for Office.js
\f0\i0 \cf4 \cb1 \strokec4 \
\cb3           \cf7 \cb3 \strokec7 let\cf4 \cb3 \strokec4  \cf5 \strokec5 attempts\cf4 \strokec4  \cf10 \cb3 \strokec10 =\cf4 \cb3 \strokec4  \cf13 \cb3 \strokec13 0\cf4 \cb3 \strokec4 ;\cb1 \
\cb3           \cf7 \cb3 \strokec7 const\cf4 \cb3 \strokec4  \cf9 \cb3 \strokec9 maxAttempts\cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 =\cf4 \cb3 \strokec4  \cf13 \cb3 \strokec13 20\cf4 \cb3 \strokec4 ; 
\f2\i \cf12 \strokec12 // 20 * 250ms = 5 seconds
\f0\i0 \cf4 \cb1 \strokec4 \
\cb3           \cb1 \
\cb3           \cf2 \strokec2 while\cf4 \strokec4  (\cf5 \strokec5 attempts\cf4 \strokec4  \cf10 \cb3 \strokec10 <\cf4 \cb3 \strokec4  \cf9 \cb3 \strokec9 maxAttempts\cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 &&\cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 !\cf13 \strokec13 isOfficeReady\cf4 \cb3 \strokec4 () \cf10 \cb3 \strokec10 &&\cf4 \cb3 \strokec4  \cf5 \strokec5 mounted\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf2 \strokec2 await\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf11 \cb3 \strokec11 Promise\cf4 \cb3 \strokec4 (
\f1\b \cf8 \cb3 \strokec8 resolve
\f0\b0 \cf4 \cb3 \strokec4  \cf7 \cb3 \strokec7 =>\cf4 \cb3 \strokec4  \cf13 \cb3 \strokec13 setTimeout\cf4 \cb3 \strokec4 (\cf13 \cb3 \strokec13 resolve\cf4 \cb3 \strokec4 , \cf13 \cb3 \strokec13 250\cf4 \cb3 \strokec4 ));\cb1 \
\cb3             \cf5 \strokec5 attempts\cf10 \cb3 \strokec10 ++\cf4 \cb3 \strokec4 ;\cb1 \
\cb3           \}\cb1 \
\cb3           \cb1 \
\cb3           \cf2 \strokec2 if\cf4 \strokec4  (\cf10 \cb3 \strokec10 !\cf5 \cb3 \strokec5 mounted\cf4 \strokec4 ) \cf2 \strokec2 return\cf4 \strokec4 ;\cb1 \
\cb3           \cb1 \
\cb3           \cf2 \strokec2 if\cf4 \strokec4  (\cf10 \cb3 \strokec10 !\cf13 \strokec13 isOfficeReady\cf4 \cb3 \strokec4 ()) \{\cb1 \
\cb3             \cf2 \strokec2 throw\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf11 \cb3 \strokec11 Error\cf4 \cb3 \strokec4 (\cf6 \strokec6 'Office.js failed to initialize within 5 seconds'\cf4 \strokec4 );\cb1 \
\cb3           \}\cb1 \
\cb3         \}\cb1 \
\
\cb3         
\f2\i \cf12 \strokec12 // Check if we're in Word
\f0\i0 \cf4 \cb1 \strokec4 \
\cb3         \cf2 \strokec2 if\cf4 \strokec4  (\cf10 \cb3 \strokec10 !\cf13 \strokec13 isWordHost\cf4 \cb3 \strokec4 ()) \{\cb1 \
\cb3           \cf10 \cb3 \strokec10 console\cf4 \cb3 \strokec4 .\cf8 \cb3 \strokec8 warn\cf4 \cb3 \strokec4 (\cf6 \strokec6 'useWordJs: Not running in Word'\cf4 \strokec4 );\cb1 \
\cb3           \cf2 \strokec2 throw\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf11 \cb3 \strokec11 Error\cf4 \cb3 \strokec4 (\cf6 \strokec6 'This add-in must run in Microsoft Word'\cf4 \strokec4 );\cb1 \
\cb3         \}\cb1 \
\
\cb3         
\f2\i \cf12 \strokec12 // Wait for Word.js with shorter timeout
\f0\i0 \cf4 \cb1 \strokec4 \
\cb3         \cf2 \strokec2 try\cf4 \strokec4  \{\cb1 \
\cb3           \cf2 \strokec2 await\cf4 \strokec4  \cf8 \cb3 \strokec8 waitForWordJs\cf4 \cb3 \strokec4 (\cf13 \cb3 \strokec13 5000\cf4 \cb3 \strokec4 ); 
\f2\i \cf12 \strokec12 // 5 second timeout
\f0\i0 \cf4 \cb1 \strokec4 \
\cb3           \cf2 \strokec2 if\cf4 \strokec4  (\cf5 \strokec5 mounted\cf4 \strokec4 ) \{\cb1 \
\cb3             \cf8 \cb3 \strokec8 setIsReady\cf4 \cb3 \strokec4 (true);\cb1 \
\cb3             \cf8 \cb3 \strokec8 setError\cf4 \cb3 \strokec4 (null);\cb1 \
\cb3           \}\cb1 \
\cb3         \} \cf2 \strokec2 catch\cf4 \strokec4  (\cf5 \strokec5 timeoutError\cf4 \strokec4 ) \{\cb1 \
\cb3           \cf2 \strokec2 throw\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf8 \cb3 \strokec8 Error\cf4 \cb3 \strokec4 (\cf6 \strokec6 'Word.js initialization timeout'\cf4 \strokec4 );\cb1 \
\cb3         \}\cb1 \
\
\cb3       \} \cf2 \strokec2 catch\cf4 \strokec4  (\cf5 \strokec5 err\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf10 \cb3 \strokec10 console\cf4 \cb3 \strokec4 .\cf8 \cb3 \strokec8 error\cf4 \cb3 \strokec4 (\cf6 \strokec6 'useWordJs: Initialization error:'\cf4 \strokec4 , \cf5 \strokec5 err\cf4 \strokec4 );\cb1 \
\cb3         \cf2 \strokec2 if\cf4 \strokec4  (\cf5 \strokec5 mounted\cf4 \strokec4 ) \{\cb1 \
\cb3           \cf8 \cb3 \strokec8 setError\cf4 \cb3 \strokec4 (\cf5 \strokec5 err\cf4 \strokec4  \cf2 \strokec2 instanceof\cf4 \strokec4  \cf8 \cb3 \strokec8 Error\cf4 \cb3 \strokec4  \cf2 \strokec2 ?\cf4 \strokec4  \cf10 \cb3 \strokec10 err\cf4 \cb3 \strokec4 .\cf9 \cb3 \strokec9 message\cf4 \cb3 \strokec4  \cf2 \strokec2 :\cf4 \strokec4  \cf6 \strokec6 'Initialization failed'\cf4 \strokec4 );\cb1 \
\cb3           \cf8 \cb3 \strokec8 setIsReady\cf4 \cb3 \strokec4 (false);\cb1 \
\cb3         \}\cb1 \
\cb3       \} \cf2 \strokec2 finally\cf4 \strokec4  \{\cb1 \
\cb3         \cf2 \strokec2 if\cf4 \strokec4  (\cf5 \strokec5 mounted\cf4 \strokec4 ) \{\cb1 \
\cb3           \cf8 \cb3 \strokec8 setIsLoading\cf4 \cb3 \strokec4 (false);\cb1 \
\cb3         \}\cb1 \
\cb3       \}\cb1 \
\cb3     \};\cb1 \
\
\cb3     \cf13 \cb3 \strokec13 initializeWordJs\cf4 \cb3 \strokec4 ();\cb1 \
\
\cb3     \cf2 \strokec2 return\cf4 \strokec4  () \cf7 \cb3 \strokec7 =>\cf4 \cb3 \strokec4  \{\cb1 \
\cb3       \cf5 \strokec5 mounted\cf4 \strokec4  \cf10 \cb3 \strokec10 =\cf4 \cb3 \strokec4  false;\cb1 \
\cb3       \cf2 \strokec2 if\cf4 \strokec4  (\cf5 \strokec5 timeoutId\cf4 \strokec4 ) \{\cb1 \
\cb3         \cf13 \cb3 \strokec13 clearTimeout\cf4 \cb3 \strokec4 (\cf5 \strokec5 timeoutId\cf4 \strokec4 );\cb1 \
\cb3       \}\cb1 \
\cb3     \};\cb1 \
\cb3   \}, \cf10 \cb3 \strokec10 []\cf4 \cb3 \strokec4 );\cb1 \
\
\cb3   
\f2\i \cf12 \strokec12 /**
\f0\i0 \cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0

\f2\i \cf12 \cb3 \strokec12    * Execute a Word.js operation safely
\f0\i0 \cf4 \cb1 \strokec4 \

\f2\i \cf12 \cb3 \strokec12    */
\f0\i0 \cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3   \cf7 \cb3 \strokec7 const\cf4 \cb3 \strokec4  
\f1\b \cf8 \cb3 \strokec8 execute
\f0\b0 \cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 =\cf4 \cb3 \strokec4  \cf7 \cb3 \strokec7 async\cf4 \cb3 \strokec4  <\cf8 \cb3 \strokec8 T\cf4 \cb3 \strokec4 >(
\f1\b \cf8 \cb3 \strokec8 operation
\f0\b0 \cf10 \strokec10 :\cf4 \cb3 \strokec4  () \cf7 \cb3 \strokec7 =>\cf4 \cb3 \strokec4  \cf11 \cb3 \strokec11 Promise\cf4 \cb3 \strokec4 <\cf8 \cb3 \strokec8 T\cf4 \cb3 \strokec4 >)\cf10 \cb3 \strokec10 :\cf4 \cb3 \strokec4  \cf11 \cb3 \strokec11 Promise\cf4 \cb3 \strokec4 <\cf8 \cb3 \strokec8 T\cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 |\cf4 \cb3 \strokec4  \cf7 \cb3 \strokec7 null\cf4 \cb3 \strokec4 > \cf7 \cb3 \strokec7 =>\cf4 \cb3 \strokec4  \{\cb1 \
\cb3     \cf2 \strokec2 if\cf4 \strokec4  (\cf10 \cb3 \strokec10 !\cf9 \strokec9 isReady\cf4 \cb3 \strokec4 ) \{\cb1 \
\cb3       \cf7 \cb3 \strokec7 const\cf4 \cb3 \strokec4  \cf9 \cb3 \strokec9 errorMsg\cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 =\cf4 \cb3 \strokec4  \cf9 \cb3 \strokec9 error\cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 ||\cf4 \cb3 \strokec4  \cf6 \strokec6 'Word.js is not ready'\cf4 \strokec4 ;\cb1 \
\cb3       \cf13 \cb3 \strokec13 setError\cf4 \cb3 \strokec4 (\cf9 \cb3 \strokec9 errorMsg\cf4 \cb3 \strokec4 );\cb1 \
\cb3       \cf10 \cb3 \strokec10 console\cf4 \cb3 \strokec4 .\cf8 \cb3 \strokec8 warn\cf4 \cb3 \strokec4 (\cf6 \strokec6 'useWordJs: Operation attempted but Word.js not ready:'\cf4 \strokec4 , \cf9 \cb3 \strokec9 errorMsg\cf4 \cb3 \strokec4 );\cb1 \
\cb3       \cf2 \strokec2 return\cf4 \strokec4  null;\cb1 \
\cb3     \}\cb1 \
\
\cb3     \cf2 \strokec2 try\cf4 \strokec4  \{\cb1 \
\cb3       \cf13 \cb3 \strokec13 setError\cf4 \cb3 \strokec4 (null);\cb1 \
\cb3       \cf7 \cb3 \strokec7 const\cf4 \cb3 \strokec4  \cf9 \cb3 \strokec9 result\cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 =\cf4 \cb3 \strokec4  \cf2 \strokec2 await\cf4 \strokec4  \cf13 \cb3 \strokec13 operation\cf4 \cb3 \strokec4 ();\cb1 \
\cb3       \cf10 \cb3 \strokec10 console\cf4 \cb3 \strokec4 .\cf8 \cb3 \strokec8 log\cf4 \cb3 \strokec4 (\cf6 \strokec6 'useWordJs: Operation completed successfully'\cf4 \strokec4 );\cb1 \
\cb3       \cf2 \strokec2 return\cf4 \strokec4  \cf9 \cb3 \strokec9 result\cf4 \cb3 \strokec4 ;\cb1 \
\cb3     \} \cf2 \strokec2 catch\cf4 \strokec4  (\cf5 \strokec5 err\cf4 \strokec4 ) \{\cb1 \
\cb3       \cf7 \cb3 \strokec7 const\cf4 \cb3 \strokec4  \cf9 \cb3 \strokec9 errorMessage\cf4 \cb3 \strokec4  \cf10 \cb3 \strokec10 =\cf4 \cb3 \strokec4  \cf5 \strokec5 err\cf4 \strokec4  \cf2 \strokec2 instanceof\cf4 \strokec4  \cf11 \cb3 \strokec11 Error\cf4 \cb3 \strokec4  \cf2 \strokec2 ?\cf4 \strokec4  \cf5 \strokec5 err\cf4 \strokec4 .\cf9 \cb3 \strokec9 message\cf4 \cb3 \strokec4  \cf2 \strokec2 :\cf4 \strokec4  \cf6 \strokec6 'Operation failed'\cf4 \strokec4 ;\cb1 \
\cb3       \cf13 \cb3 \strokec13 setError\cf4 \cb3 \strokec4 (\cf9 \cb3 \strokec9 errorMessage\cf4 \cb3 \strokec4 );\cb1 \
\cb3       \cf10 \cb3 \strokec10 console\cf4 \cb3 \strokec4 .\cf8 \cb3 \strokec8 error\cf4 \cb3 \strokec4 (\cf6 \strokec6 'Word.js operation failed:'\cf4 \strokec4 , \cf5 \strokec5 err\cf4 \strokec4 );\cb1 \
\cb3       \cf2 \strokec2 return\cf4 \strokec4  null;\cb1 \
\cb3     \}\cb1 \
\cb3   \};\cb1 \
\
\cb3   
\f2\i \cf12 \strokec12 // Debug logging
\f0\i0 \cf4 \cb1 \strokec4 \
\cb3   \cf13 \cb3 \strokec13 useEffect\cf4 \cb3 \strokec4 (() \cf7 \cb3 \strokec7 =>\cf4 \cb3 \strokec4  \{\cb1 \
\cb3     \cf10 \cb3 \strokec10 console\cf4 \cb3 \strokec4 .\cf8 \cb3 \strokec8 log\cf4 \cb3 \strokec4 (\cf6 \strokec6 'useWordJs state update:'\cf4 \strokec4 , \{ \cf9 \cb3 \strokec9 isReady\cf4 \cb3 \strokec4 , \cf9 \cb3 \strokec9 isLoading\cf4 \cb3 \strokec4 , \cf9 \cb3 \strokec9 error\cf4 \cb3 \strokec4  \});\cb1 \
\cb3   \}, \cf10 \cb3 \strokec10 [\cf9 \strokec9 isReady\cf4 \cb3 \strokec4 , \cf9 \cb3 \strokec9 isLoading\cf4 \cb3 \strokec4 , \cf9 \cb3 \strokec9 error\cf10 \strokec10 ]\cf4 \cb3 \strokec4 );\cb1 \
\
\cb3   \cf2 \strokec2 return\cf4 \strokec4  \{\cb1 \
\cb3     \cf9 \cb3 \strokec9 isReady\cf4 \cb3 \strokec4 ,\cb1 \
\cb3     \cf9 \cb3 \strokec9 isLoading\cf4 \cb3 \strokec4 ,\cb1 \
\cb3     \cf9 \cb3 \strokec9 error\cf4 \cb3 \strokec4 ,\cb1 \
\cb3     
\f1\b \cf8 \cb3 \strokec8 execute
\f0\b0 \cf4 \cb3 \strokec4 ,\cb1 \
\cb3   \};\cb1 \
\cb3 \}\cb1 \
}